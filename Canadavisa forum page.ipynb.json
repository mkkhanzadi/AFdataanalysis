{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests\n",
    "import bs4\n",
    "from bs4 import BeautifulSoup as bs\n",
    "import csv\n",
    "import re\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import nltk\n",
    "import random\n",
    "# from https://github.com/pandas-dev/pandas/issues/22610\n",
    "import csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "#defining the url and using the ureq to read the website in html. This can be checked by print(canadavisa)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "canadavisa_url = 'https://www.canadavisa.com/canada-immigration-discussion-board/'\n",
    "canadavisa = requests.get(canadavisa_url).text"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#all topics are in tag 'h3' - using bs to find all data in h3 - Topic tag has changed from nodeTitle to node-title"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'Express Entry / Expression of Interest\\nNew': '/canada-immigration-discussion-board/forums/express-entry-expression-of-interest.54/', 'Skilled Worker / Professional Immigration\\nNew': '/canada-immigration-discussion-board/forums/skilled-worker-professional-immigration.4/', 'Canadian Experience Class\\nNew': '/canada-immigration-discussion-board/forums/canadian-experience-class.52/', 'Provincial Nomination Program Immigration\\nNew': '/canada-immigration-discussion-board/forums/provincial-nomination-program-immigration.6/', 'Family Class Sponsorship\\nNew': '/canada-immigration-discussion-board/forums/family-class-sponsorship.5/', 'Caregiver Pathways\\nNew': '/canada-immigration-discussion-board/forums/caregiver-pathways.65/', 'Quebec Immigration\\nNew': '/canada-immigration-discussion-board/forums/quebec-immigration.55/', 'Business Immigration\\nNew': '/canada-immigration-discussion-board/forums/business-immigration.7/', 'IELTS - CELPIP - TEF - TCF - Language Testing\\nNew': '/canada-immigration-discussion-board/forums/ielts-celpip-tef-tcf-language-testing.53/', 'Refugees and Asylum\\nNew': '/canada-immigration-discussion-board/forums/refugees-and-asylum.56/', 'General - All Canadian Immigration\\nNew': '/canada-immigration-discussion-board/forums/general-all-canadian-immigration.13/', 'Permanent Residence in Canada\\nNew': '/canada-immigration-discussion-board/forums/permanent-residence-in-canada.57/', 'Temporary Residence in Canada (Work, Study, Visit)\\nNew': '/canada-immigration-discussion-board/forums/temporary-residence-in-canada-work-study-visit.58/', 'H-1B Holders in the U.S.\\nNew': '/canada-immigration-discussion-board/forums/h-1b-holders-in-the-u-s.59/', 'Foreign Workers\\nNew': '/canada-immigration-discussion-board/forums/foreign-workers.10/', 'International Students\\nNew': '/canada-immigration-discussion-board/forums/international-students.2/', 'Visitors\\nNew': '/canada-immigration-discussion-board/forums/visitors.8/', 'Settlement Issues\\nNew': '/canada-immigration-discussion-board/forums/settlement-issues.14/', 'Permanent Residency Obligations\\nNew': '/canada-immigration-discussion-board/forums/permanent-residency-obligations.11/', 'Citizenship\\nNew': '/canada-immigration-discussion-board/forums/citizenship.12/', 'Housing\\nNew': '/canada-immigration-discussion-board/forums/housing.39/', 'Education\\nNew': '/canada-immigration-discussion-board/forums/education.41/', 'Health\\nNew': '/canada-immigration-discussion-board/forums/health.40/', 'Finding Work in Canada\\nNew': '/canada-immigration-discussion-board/forums/finding-work-in-canada.21/', 'Canadian Finance and Taxation\\nNew': '/canada-immigration-discussion-board/forums/canadian-finance-and-taxation.25/', 'Start Your Own Business in Canada – Self Employmen\\nNew': '/canada-immigration-discussion-board/forums/start-your-own-business-in-canada-%E2%80%93-self-employmen.22/', 'Canadian Labour Legislation\\nNew': '/canada-immigration-discussion-board/forums/canadian-labour-legislation.23/', 'Resources for Finding a Canadian Job\\nNew': '/canada-immigration-discussion-board/forums/resources-for-finding-a-canadian-job.24/', 'Visa Offices in North America\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-north-america.18/', 'Visa Offices in South America\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-south-america.19/', 'Visa Offices in Europe\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/', 'Visa Offices in Asia\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-asia.16/', 'Visa Offices in Africa\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-africa.15/', 'Visa Offices in Oceana\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-oceana.20/'}\n"
     ]
    }
   ],
   "source": [
    "soup = bs(canadavisa, 'html.parser')\n",
    "\n",
    "topics = soup.find_all('h3', {'class':'node-title'})\n",
    "topic_titles = list(map(lambda h: h.text.strip(), topics))\n",
    "topic_titles_and_links = dict(map(lambda h: (h.text.strip(), h.find('a') ['href']), topics))\n",
    "print(topic_titles_and_links)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "LM's example of randomised topic selection. Uses [sampling without replacement](https://web.ma.utexas.edu/users/parker/sampling/repl.htm) to ensure the same topic is not selected twice ."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Express Entry / Expression of Interest\\nNew': '/canada-immigration-discussion-board/forums/express-entry-expression-of-interest.54/',\n",
       " 'Skilled Worker / Professional Immigration\\nNew': '/canada-immigration-discussion-board/forums/skilled-worker-professional-immigration.4/',\n",
       " 'Canadian Experience Class\\nNew': '/canada-immigration-discussion-board/forums/canadian-experience-class.52/',\n",
       " 'Provincial Nomination Program Immigration\\nNew': '/canada-immigration-discussion-board/forums/provincial-nomination-program-immigration.6/',\n",
       " 'Family Class Sponsorship\\nNew': '/canada-immigration-discussion-board/forums/family-class-sponsorship.5/',\n",
       " 'Caregiver Pathways\\nNew': '/canada-immigration-discussion-board/forums/caregiver-pathways.65/',\n",
       " 'Quebec Immigration\\nNew': '/canada-immigration-discussion-board/forums/quebec-immigration.55/',\n",
       " 'Business Immigration\\nNew': '/canada-immigration-discussion-board/forums/business-immigration.7/',\n",
       " 'IELTS - CELPIP - TEF - TCF - Language Testing\\nNew': '/canada-immigration-discussion-board/forums/ielts-celpip-tef-tcf-language-testing.53/',\n",
       " 'Refugees and Asylum\\nNew': '/canada-immigration-discussion-board/forums/refugees-and-asylum.56/',\n",
       " 'General - All Canadian Immigration\\nNew': '/canada-immigration-discussion-board/forums/general-all-canadian-immigration.13/',\n",
       " 'Permanent Residence in Canada\\nNew': '/canada-immigration-discussion-board/forums/permanent-residence-in-canada.57/',\n",
       " 'Temporary Residence in Canada (Work, Study, Visit)\\nNew': '/canada-immigration-discussion-board/forums/temporary-residence-in-canada-work-study-visit.58/',\n",
       " 'H-1B Holders in the U.S.\\nNew': '/canada-immigration-discussion-board/forums/h-1b-holders-in-the-u-s.59/',\n",
       " 'Foreign Workers\\nNew': '/canada-immigration-discussion-board/forums/foreign-workers.10/',\n",
       " 'International Students\\nNew': '/canada-immigration-discussion-board/forums/international-students.2/',\n",
       " 'Visitors\\nNew': '/canada-immigration-discussion-board/forums/visitors.8/',\n",
       " 'Settlement Issues\\nNew': '/canada-immigration-discussion-board/forums/settlement-issues.14/',\n",
       " 'Permanent Residency Obligations\\nNew': '/canada-immigration-discussion-board/forums/permanent-residency-obligations.11/',\n",
       " 'Citizenship\\nNew': '/canada-immigration-discussion-board/forums/citizenship.12/',\n",
       " 'Housing\\nNew': '/canada-immigration-discussion-board/forums/housing.39/',\n",
       " 'Education\\nNew': '/canada-immigration-discussion-board/forums/education.41/',\n",
       " 'Health\\nNew': '/canada-immigration-discussion-board/forums/health.40/',\n",
       " 'Finding Work in Canada\\nNew': '/canada-immigration-discussion-board/forums/finding-work-in-canada.21/',\n",
       " 'Canadian Finance and Taxation\\nNew': '/canada-immigration-discussion-board/forums/canadian-finance-and-taxation.25/',\n",
       " 'Start Your Own Business in Canada – Self Employmen\\nNew': '/canada-immigration-discussion-board/forums/start-your-own-business-in-canada-%E2%80%93-self-employmen.22/',\n",
       " 'Canadian Labour Legislation\\nNew': '/canada-immigration-discussion-board/forums/canadian-labour-legislation.23/',\n",
       " 'Resources for Finding a Canadian Job\\nNew': '/canada-immigration-discussion-board/forums/resources-for-finding-a-canadian-job.24/',\n",
       " 'Visa Offices in North America\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-north-america.18/',\n",
       " 'Visa Offices in South America\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-south-america.19/',\n",
       " 'Visa Offices in Europe\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/',\n",
       " 'Visa Offices in Asia\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-asia.16/',\n",
       " 'Visa Offices in Africa\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-africa.15/',\n",
       " 'Visa Offices in Oceana\\nNew': '/canada-immigration-discussion-board/forums/visa-offices-in-oceana.20/'}"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "topic_titles_and_links"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('titles_and_links.csv', mode='w') as csv_file:\n",
    "    fieldnames = ['title', 'link']\n",
    "    writer = csv.DictWriter(csv_file, fieldnames=fieldnames)\n",
    "\n",
    "    writer.writeheader()\n",
    "    for key, value in topic_titles_and_links.items():\n",
    "        writer.writerow({'title': key, 'link': value})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "def sample_links(titles_and_links, titles, sample_size):\n",
    "   num_links = len(titles_and_links)\n",
    "   sample_titles_and_links = {}\n",
    "   ids = []\n",
    "\n",
    "   #This code creates an array of topic ids that are random and unique\n",
    "   if sample_size < num_links:\n",
    "       for i in range(0, sample_size):\n",
    "           x = -1\n",
    "            \n",
    "           while not(x in ids):\n",
    "               x = random.randint(0, num_links)\n",
    "               ids.append(x)\n",
    "\n",
    "   # Now create the topic sample\n",
    "   if len(ids) > 0:\n",
    "       for i in ids:\n",
    "           if (i < len(titles)):\n",
    "               key = titles[i]\n",
    "               sample_titles_and_links[key] = titles_and_links[key]\n",
    "        \n",
    "   return sample_titles_and_links\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "def data_frame(message_ids, links, date_contents, username_contents, message_contents, countries, likes, topic_contents, thread_contents):\n",
    "    base_data_frame = pd.DataFrame({ \"ID\": message_ids, \n",
    "                                \"Link\": links, \n",
    "                                \"Date\": date_contents,\n",
    "                                \"Username\": username_contents, \n",
    "                                \"Message\": message_contents, \n",
    "                                \"Country\": countries, \n",
    "                                \"Like\": likes, \n",
    "                                \"Topic\": topic_contents, \n",
    "                                \"Thread\": thread_contents})\n",
    "    return base_data_frame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "def write_csv(file_name, base_data_frame):\n",
    "    with open(file_name, \"w\", errors='surrogatepass') as _file:\n",
    "        writer = csv.writer(_file)\n",
    "        #writer.writerow(row)\n",
    "        writer.writerow(base_data_frame.columns.values)\n",
    "        for index, row in base_data_frame.iterrows():\n",
    "            writer.writerow(row)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "SAMPLE_SIZE = 30\n",
    "PAGE_SAMPLE_SIZE = 70"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "topic_sample_titles_and_links = sample_links(topic_titles_and_links, topic_titles, SAMPLE_SIZE)\n",
    "##print(topic_sample_titles_and_links)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "##print(topic_sample_titles_and_links)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Processing  Visa Offices in Europe\n",
      "New\n",
      "Count of topic pages: 5\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/schengen-visa.656723/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-from-paris.636790/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-job-and-visa-in-canda.674760/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/has-anyone-had-any-hold-up-with-their-passport-at-the-uk-customs.521459/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/health-coverage-for-child-birth-on-first-month-of-my-recent-university-job-postdoc.601084/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/rome-italy-office.160974/\n",
      "Count of thread pages: 40\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/eta-arrested-for-drink-driving-at-the-roadside-but-blew-under-at-the-station.395228/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-office-hours.622200/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/financial-support.569464/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/vienna-time-for-issuing-visa.139488/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/kyiv-visa-office-fsw-applicants-lets-connect-here.585364/\n",
      "Count of thread pages: 8\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/i-have-issue.526890/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/outland-spouse-visa-from-italy-rome.519108/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-office-london-processing-times.634554/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/uae-police-certificate-from-rome.591630/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-time-has-exceeded-the-standard-processing-time-no-response-from-uk-office-visitor-visa.648761/\n",
      "Count of thread pages: 3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/my-applicant-name-is-written-wrong.610441/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/london-visa-office.646881/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-exempt-condition.586330/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-application-in-london.572802/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-for-canada-walk-in-submission.596954/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/bucharest-vo-processing-time.440048/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/iec-work-visa-application-error-question.557234/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visitor-visa-background-check.615403/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/eta.575268/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/declined-transaction-not-approved.560331/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-from-paris-processing-time-online-paper.385233/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/dealing-with-ppr-through-london-office.589214/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/applicants-vo-vienna-please-join.79097/\n",
      "Count of thread pages: 251\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/page-2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/help.402377/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-move-canada-passport-holder-to-uk-for-work.472026/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/time-taken-for-registered-post-passport-return.453770/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/vac-process.411828/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/mistakenly-revoked-gckey.178472/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/do-i-need-transit-visa-in-milan-when-flying-from-toronto-to-new-delhi.278120/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/london-office-travel-document.431568/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-from-germany.130608/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-retrieve-a-saved-filled-out-pdf-immigration-form-saved-on-my-laptop.363219/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/fsw-visa-for-ukrainians.259988/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/passport-request-help-needed.518918/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/indian-student-living-in-bulgaria-canada-study-permit-refused.495368/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/do-i-need-transit-visa-in-amsterdam-airport-in-netherland.488077/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/application-for-travel-document-permanent-resident.400750/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/spousal-immigration-previous-undertaking-need-help.253853/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-do-i-request-london-uk-for-processing.268845/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/paris-approved-online-visa-passport-return-times-no-return-envelope-enclosed.283143/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/iec-personal-details-form-says-in-progress.408529/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-is-imm5785-in-copr-from-london-vo.395953/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/no-response-yet-for-visitor-visa-application-submitted-online-in-uk.153598/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/vienna-embassy-study-permit.430386/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/transit-for-uk.496402/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-send-family-photos-to-lvo.450838/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/vac-in-rome-italy.428827/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-time-permanent-resident-travel-document-prtd-london-visa-office.473220/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/page-3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/hi.165334/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/passports-not-received-from-london-office-of-canada-immigration.152101/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/advice-please.139497/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/hi.247462/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-advice-about-getting-my-visa-to-canada.130946/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sponsoring-english-husband.221119/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/people-who-have-submitted-passports-to-london.180270/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-time-for-visitor-visas-at-moscow-office.82181/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-sucesfully-obtain-trv.230597/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/passport-for-stamping-via-post-or-in-person.115450/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/application-via-mail-times.142324/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit-problem.159893/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-time-vienna-vo.154185/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/last-week-anyone-got-visa-from-london-visa-office.162407/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/spouse-sponsorship-london-visa-office-pakistan-cases.249416/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/live-in-caregiver-applicants-who-applied-at-london-visa-office.190683/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/strike.152252/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-times-in-paris.99405/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/temporary-work-permit-twp-applicants-to-visa-office-vienna-share-timeline.237008/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-processing-office-for-saudi-arabia.141730/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sponsoring-my-orphan-niece-from-greece.228418/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/cic-log-in-problem-heeeeelllpp.200139/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/doi-need-transit-visa-in-heatthrow-4-indian-national-having-valid-canadian-visa.138234/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/passport-with-london-high-commission.175137/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/application-in-middle-of-september-received-per.252848/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/page-4\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-office-in-paris.91165/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/calling-all-berlin-applicants.18994/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/italy-spouse-visa.87124/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/iec-awaiting-acknowledgment-of-receipt-after-6-weeks.96182/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/urgent-can-anyone-help.117488/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/invitation-2012-china-international-immigration-expo.99519/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/iec-for-2010.87581/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/those-who-applied-in-between-july-and-december-2011.125985/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/time-duration-to-issue-aor2-from-london.102476/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-application-through-high-commission-london.97317/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/iec-criminal-records-need-some-help-please.96048/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/morocain-girl-married-british-man-need-information.130824/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/pr-rocessing-times-sponsoring-a-uk-parent.95528/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/london-office.8762/\n",
      "Count of thread pages: 3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/where-i-can-apply.88741/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/my-case-is-a-story.103436/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/new-process-timing-by-london-visa-office-for-invester-category.78997/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/if-my-visa-comes-after-my-departure-how-do-i-activate-it-in-canada.104490/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/uk-visa-office-no-update-since-july-13th.70946/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/which-visa-do-i-need.98092/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-anyone-help-me-out-my-application-reached-london-vo-on-aug-01.79448/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/contact-canadian-medical-officer-in-london.53874/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-format-is-the-entry-date-on-the-iec-introduction-letter.121507/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/1-if-application-lost-by-courier-2-to-add-my-wife-in-my-application.79084/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/moscow-office-visa-charge-refund-passport-request.67390/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/visa-offices-in-europe.17/page-5\n",
      "Processing  Canadian Labour Legislation\n",
      "New\n",
      "Count of topic pages: 3\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/canadian-labour-legislation.23/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-experience-certificate.589730/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/expired-pr-card-impact-on-employment.550819/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/owning-a-business-while-working-for-another-employer.522860/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/help-pr-application-rejected-and-work-permit-still-under-processing.499855/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/suspension.643454/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-exempt-condition.586329/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-in-canada-while-waiting-my-workpermit-is-in-the-proccess-of-being-renewed.664877/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/citizenship.569994/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/overtime-in-alberta.570184/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-cheak.662920/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/day-off-for-wedding.656044/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/real-or-fake.652471/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/foreign-pharmacists-in-canada.552772/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia.532156/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-number-check.623559/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-check-lmia-letter.561540/\n",
      "Count of thread pages: 22\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/re-medical-test-to-work-in-healthcare-field.668107/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/working-during-break-affected-to-work-permit.625642/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-remote-for-us-based-employer.599885/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-track.653031/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-eligibility-when-transferring-colleges.596809/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/check-my-lmia.683435/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-processing-time.681161/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/working-for-a-canadian-company-remotely-without-a-canadian-citizenship-or-permanent-reaidency.603810/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/working-for-us-company-on-canadian-owp.631616/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/truck-driver-license-num-4.666840/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/mba-from-uk-university-of-sheffield-recognised-in-canada.509393/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/canadian-labour-legislation.23/page-2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-question-urgent.184419/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-should-i-do-if-my-employer-dont-pay-me.297835/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/not-paid-ot-legal.457217/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/why-the-lmia-lmo-takes-so-long.246437/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/help-me-understand-the-160-hour-month-scenario.310777/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/employee-refuses-to-honour-lcp-contract-after-positive-lmo-help.174113/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-issues-and-other-please-help.136532/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/should-i-hire-a-law-firm-for-pr-or-apply-online-on-my-own.230333/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/fail-to-work-for-a-company-after-contract-sign.271414/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-work-hours.384775/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-help-with-some-questions-advices.480394/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-contract-broken-please-help.188055/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-help.135225/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/vacation-entitlement-in-canada.110586/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/claimant-insurance-benefits-session-missed.459862/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/co-op-work-permit.142914/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/salary-increase.356817/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-high-wage-limit.290147/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-help-regarding-termination-of-working-permit.135512/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/please-help-stolen-sin-and-all-very-important-documents.297735/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-it-counted-as-working-overtime-need-help.459400/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-to-hire-nanny-for-12yo-child.500122/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/topic-paid-vacation-pgwp-and-ee.280818/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-experience.465839/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/canadian-labour-legislation.23/page-3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-can-i-expect-in-quebec.66845/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/problem-with-company.30396/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/qualification-conversion.134661/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/employed-by-uk-company-living-in-canada.59334/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/employment-insurance-need-help-urgent.84205/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-get-a-job-in-worker-or-get-any-sonser.53062/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/requirements-for-hairdressers-in-calgary.125720/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/kindly-help-me.88408/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-work-remotely-for-a-canadian-company.86111/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-needed-for-summer-camp-work.98091/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/certified-hr-professional-chrp-need-info.54800/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/pressured-to-work-illegaly.136725/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/working-with-an-employer-in-pgwp-how-to-extend-my-wp-procedures.119756/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/working-conditions.5940/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/all-about-medical.99807/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-apply-for-canadian-registered-nurse-examination-from-philippines-please.88966/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/does-part-time-not-need-contract.132266/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmo-question-help.76802/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/international-students-do-we-get-the-same-wage.89340/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/working-hours.20537/\n",
      "Processing  Quebec Immigration\n",
      "New\n",
      "Count of topic pages: 45\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/july-2019-federal-application-after-csq-paper-based.647224/\n",
      "Count of thread pages: 5\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/police-certificate-request-saudi-arabia.682020/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/french-requirements-for-csq-peq.682146/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/hello.680820/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/does-a-course-based-masters-program-that-doesnt-have-a-thesis-qualify-for-peq.683143/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/montreal-inland-landing-walk-in.653325/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/about-w1-visa.683542/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-holding-visitor.683772/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/best-way-to-get-my-us-wife-to-montreal.681373/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-under-peq-graduate-or-worker.679814/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/any-malayali-in-cegep-de-la-gasp%C3%A9sie-et-des-iles.648007/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-graduates-any-applicants-from-november-2019.679678/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-personalized-checklist.682132/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/waiting-for-caq.553166/\n",
      "Count of thread pages: 35\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-for-november-2019-applicants.680476/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/employer-restricted-work-permit.682595/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-processing-time-temporary-foreigner-worker-program.659150/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/clarifications-on-biometrics-after-csq-for-federal.681660/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-aot-please-help.681305/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-rejected.526623/\n",
      "Count of thread pages: 7\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/matrix-college-offer.677253/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-application-using-a-mon-project-it-is-already-13-months.607301/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-i-get-a-close-work-permit-from-outside-of-canada-with-csq-and-visitor-visa.681431/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-documents-missing-help.681170/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/my-arrima-portal-status-filed.680845/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-duration-of-the-post-graduate-work-permit.675355/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-for-study-documents-missing.677547/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sponsorship-fraud.678685/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/spouse-sponsor-ship-case-from-pakistan.573526/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-link-family-sponsorship-account-to-my-cic-gc-key-account.675437/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-interview-2020.676612/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/time-line.676340/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/physical-disable.677682/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/any-past-or-present-student-from-lester-b-pearson-vocational-college-need-guidance.509261/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/re-quebec-parents-sponsorship-program.677005/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-this-a-fake-offer-letter-from-quebec.666250/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/apply-lmia-exemption-work-permit-out-of-canada.677075/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit-post-graduate.667818/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-i-live-and-work-in-quebec-on-my-pgwp-of-ontario.677353/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/self-employed-in-quebec.679938/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/itr-shows-nil-return.675052/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-help-for-pr-application.675856/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/delivery-driver.678848/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/immigration.679260/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/undertaking-sent-to-quebec.656820/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-expired-letter-of-attestation.495211/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-worker-calling-for-interview-and-decision-delay.662615/\n",
      "Count of thread pages: 3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/only-for-quebec-investor-program-qiip-federal-stage-since-2016-pls-come-in.612185/\n",
      "Count of thread pages: 2\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/request-to-reopen-my-case.671911/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-time-french-course.659541/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-and-sponsorship.668677/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/about-application-status.671100/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-expired-aor-not-received.465034/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-visa-approval-sep-intake-2018.573500/\n",
      "Count of thread pages: 4\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit-extension-urgent-help-needed.673002/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-quebec-city-sds-online.654691/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/manila-visa-office-vo-philippines.508212/\n",
      "Count of thread pages: 15\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-marital-status-be-changed-after-getting-the-document-request-under-new-rule.653396/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/degree-not-shown-in-arrima-quebec-portal-steps-to-resolve.585621/\n",
      "Count of thread pages: 3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/i-want-invitation-letter-from-canada.657319/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/leaving-quebec-after-pr.651893/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/atip.655883/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/adding-spouse-after-copr-request.607279/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-processing-time.657916/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebic-selection.660206/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-vs-arrima.661609/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/iec-to-common-law-sponsorship.656838/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/i-am-immigrant-and-i-accidentally-turned-on-the-fire-alarm-in-my-school-what-are-the-consequences.655035/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/score-66.661395/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/ta-ra-experience-in-arrima.654748/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/help-with-mon-projet.661504/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/moving-to-montreal-with-pr.657729/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/travel-document-pr-card.660818/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/pregnant-during-waiting-for-pr.660424/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/erroneous-birth-date-on-arrima-portal.653861/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-expiring.659833/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-for-study-no-last-name-family-name-in-the-passport.658277/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-simple-inquiries-please.660510/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-6\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-i-reuse-a-previously-acquired-csq.653703/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canada-free-visa.623660/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-experience-with-marketing-company-counts-as-valid-or-not.651176/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/independent-children-studying-outside-in-ontario-during-application.648563/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/numero-du-test-details-for-ielts.397463/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/about-point-for-working-in-quebec.649368/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/form-a-0539.653519/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/hello.654009/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/waiting-for-csq.648634/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/seeking-political-and-humanitarian-asylum.648708/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-for-studies-intention-of-refusal.570732/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/post-graduate-internship.653949/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-is-there-anyone-who-got-csq-recently-or-heard-about.563122/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/common-law-sponsorship-in-quebec.648076/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/nigerian-looking-to-live-and-work-in-canada.648292/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/changing-level-of-studies-and-dli-before-arrival-in-canada.650850/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/help-me-guys.649348/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/qu%C3%A9bec-inland-pr-sept-2018-application.654189/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-can-i-update-my-profile.651355/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/living-in-ontario-but-working-in-quebec.651875/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/after-becoming-a-pr-in-canada-through-peq-can-i-continue-my-studies-for-low-tuition-fee.649509/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/co-garant-question-for-midi.652642/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/open-work-permit-leave-canada-before-approved.654119/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/xenophobia-burns-the-xenophobes.651479/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-can-i-continue-my-education-in-quebec.591807/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/federal-stage-after-csq-via-peq.653164/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-7\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-integrate-wes-result.647280/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/demande-de-soutien.647534/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-moving-to-st-anne-de-bouville.644218/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-is-my-area-of-training.643360/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-kicking-international-students.643734/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/query-regarding-manila-study-permit.639936/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/changing-work-permit-primary-applicant-as-csq-holders.644117/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/arrima-portal.643755/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/marriage-on-work-permit.644591/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-for-university-in-montreal.639326/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/am-i-eligible-to-work-in-canada.646365/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/getting-canada-visa-to-visit-my-freelance-client.640303/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/studying-with-work-permit.639645/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/am-i-allowed-to-stay-here-while-waiting-for-an-answer-from-the-goverment.641674/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/language-skills-assessment.645718/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/got-a-message-in-arrima-that-your-ielts-will-get-expire-soon.641144/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/points-for-area-of-training-for-spouse-csq.644328/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/application-for-study-permit-from-foreign-country.639984/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/ready-for-visa-email.645464/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/copr-and-port-of-entry-under-quebec-skilled-worker-program.642151/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/refund-for-monproject.638457/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa.645647/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-application.564760/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-i-apply-to-the-caq-and-study-permit-in-the-same-time.644305/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/moving-to-quebec-from-alberta.595613/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-8\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/hello.636388/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/when-should-my-spouse-move-to-quebec.637280/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/surprising.632790/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-you-re-use-a-csq-for-new-application.636125/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lost-my-original-csq-have-to-do-my-first-landing-in-2-weeks-how-can-i-get-a-certificate-from-micc.581748/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-required-for-express-entry.635813/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canada-visa-rejected.633252/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sent-my-application-a-month-ago-and-haven%E2%80%99t-receive-the-caq.635873/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-for-my-spouse.638835/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/updated-marital-status-and-waiting-for-passport-request.635483/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/immigration-to-canada.633079/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/education-and-experience-different.633531/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/federal-process-after-aor-or-biomatric-done.633796/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-do-i-get-started.633327/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-skilled-workers-with-20-months.625668/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/foreign-pharmacist-in-quebec.635768/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/leaving-canada-as-an-inland-applicant-while-pr-application-is-processing.637362/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-advise-on-csq.639276/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/18-months-since-federal-sending.633807/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/new-rules-bill-9.638052/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq.636273/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-study-permit-issue.636021/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-quebec-aec-program-is-equivalent-to-pg.637973/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/changing-marital-status-after-uci-issued.634365/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/demande.637041/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canada-visa.632939/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/philippines-new-processing-time-from-20-to-21-months-now.636370/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/copr-visa-entry-says-one-time-entry.633192/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-9\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-skilled-workers-spouse.625015/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/abu-dhabi-vo-applications.378208/\n",
      "Count of thread pages: 64\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/pre-arrival-email.550236/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sponsoring-sons-im-a-permanent-resident-living-in-qc.626261/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/lmia-regulated-occupations-proof-that-you-meet-the-requirements.462600/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq.505036/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/degree-course-not-mentioned-in-arima.621969/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-immigration-ask-to-submit-french-b2-in-one-year.621801/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/june-2016-quebec-applicants-from-india-only-share-experiences.404332/\n",
      "Count of thread pages: 7\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/arrima-portal-draw.620714/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-refugee.620604/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/after-csq-processing-timeframe.624125/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/qswp-estimated-time-to-reveive-pr-after-medical-test-performed.621604/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/information-about-job-opportunities-in-montreal-city-for-engineers.622302/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/cqa.626332/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/address-for-pr-card.625950/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-immigration.572281/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-while-waiting-the-caq.622251/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit-expiring-what-can-i-do-what-visa-office-do-i-apply-to-for-fastest-federal-process.619295/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/an-new-email-from-midi-today.552512/\n",
      "Count of thread pages: 3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/a-0520-bf-do-i-need-to-fill-spouse-information-in-section-3-1.608457/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-it-possible-to-withdraw-mon-project-csq-application-and-get-the-refund.508179/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/got-visa-refused.624529/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-related.624494/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-processing.624926/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/options-of-immigration-to-qu%C3%A9bec.610560/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-there-a-work-permit-process-limit-at-st-bernard-de-lacolle-or-st-armand-philipsburg.623269/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-10\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/change-of-passport-number-in-caq.615451/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/good-luck-everyone.611111/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/may-intake-2019-quebec.598403/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/extending-work-permit-in-quebec-without-csq.609761/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/whats-currently-the-easiest-way-of-immigratin-to-quebec.613667/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-interviews-in-the-coming-months.611692/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/fish-packer.611378/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/which-noc-should-i-choose-helppppp-plz.617247/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/pr-for-international-students.614781/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-we-apply-for-visa.613821/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/arrima-portal-i-cannot-find-my-country-of-residence.610737/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/the-possibility-of-being-interviewed.613885/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/rally-against-quebec-immigration-on-feb-24-at-c%C3%A9gep-ahuntsic-starting-at-11-a-m.613109/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/administrative-review-no-response-for-five-months.366162/\n",
      "Count of thread pages: 12\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/comparative-evaluation.610988/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/calculate-primary-secondary-collage-or-university.617565/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/ielts-band-score-overall-6-but-5-in-one-module.568824/\n",
      "Count of thread pages: 3\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/about-student-caq.611444/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-skilled-worker-old-applicans-need-old-age-and-ielts-to-apply-again.612252/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-immigration-steps.609713/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/peq-quebec-graduate-program-processing-time.611349/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/points-for-educational-training.618001/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-application-maiden-name.617493/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-11\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/proof-of-fund-for-temporary-work-permit.605510/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/follow-up.608643/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/adding-child-to-csq.606702/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/area-of-training-for-quebec-immigration.609128/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-your-assistance.607562/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-quebec-province-suitable-for-electrical-engineering-jobs.605814/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit-extension.606989/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/we-want-to-work-and-live-for-permenant-in-quebec.608930/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/oct-2018-medical.608469/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/after-getting-visas-can-we-land-in-toronto.607492/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sample-of-admin-review-request.607529/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/can-we-eligible-for-pr.607357/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/missing-daughter-document.607330/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/aide.605148/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/software-engineer-profession.603014/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/form-a-1520-bf-quebec.608622/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/freelancer-from-usa-to-move-to-montreal.606984/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/does-a-non-accompanying-spouse-need-to-give-biometrics.605402/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-refusal-new-caq-need.607152/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/update-arrima-profile.589242/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-and-medical-exam-request.606593/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/i-sent-my-pr-application-to-the-wrong-place.606614/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/you-still-have-83-day-s-to-submit-your-request-for-update.610415/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/masters-degree-equivalency.609168/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/do-i-need-to-keep-working-while-my-federal-pr-already-have-csq-is-in-progress.608963/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/form-0546-gf.608302/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/anyone-with-csq-not-automatically-transfered-to-cic-by-midi.610367/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/demande-dinformation-sur-les-possibilit%C3%A9s-qui-soffrent-%C3%A0-moi.607504/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-12\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-stamping-from-new-delhi.604745/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/court-decision-instead-of-parental-consent.473328/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq.599370/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work.602579/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/financial-capacity-evaluation.536888/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/unable-to-download-from-arrima-portal.587814/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/ee-vs-csq-for-quebec-graduate.604480/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/has-anyone-with-french-accreditation-from-mcgill-or-such-gotten-called-in-for-a-peq-interview.529665/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/immigrate-to-canada.599906/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/information-spouse-pr-work-permit.599388/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/anyone-from-lbp-vacational-college.387041/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/visa-submitting-original-documents.602248/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-job-or-what-profession-do-you-plan-to-practice-in-qu%C3%A9bec.428909/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/query-for-the-student-visa.599527/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-bta-clearance-card.603627/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/general-information.600918/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/qiip-successful-cases-please-enlighten.602994/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-refused.558226/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/2016-batch-csq.602954/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-applications.584485/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/la-vo.601858/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/about-caq.564524/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-passport-submission-in-vfs.600162/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-for-quebec-permanent-workers-question.604235/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/november-2015-quebec-skilled-worker.384567/\n",
      "Count of thread pages: 25\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-help.602210/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/arrima-portal.599531/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit.604104/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-13\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/worried-about-caq.595169/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq.596438/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-application-notice.595900/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/federal-stage-in-peq.594502/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/i.595167/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/my-case-needs-help-do-not-mock-me-posted.596462/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/2014-applicants-not-yet-received-csq.500538/\n",
      "Count of thread pages: 11\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/info-required.596895/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/all-bd-applicants-to-share-experiences-here.392487/\n",
      "Count of thread pages: 6\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/2017-mon-projet-inland-applicants.598657/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sapana-india.596992/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/pr-first-landing-in-montreal.594926/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/part-time-graduation.597065/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/which-tef-test-can-be-used-for-both-express-entry-and-skilled-worker-quebec.454917/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-swp.594847/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/anyone-here-on-lmia-exempt-c14-visa.598642/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/sponser-child.593452/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-doctor-of-medicine-degree-considered-a-doctorate-in-quebec.594886/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/join-whatsapp-group-for-mon-project-quebec-profiles-created-on-june-20th-2016.430901/\n",
      "Count of thread pages: 10\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-holder-needs-caq-for-studying.596970/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/immgertion-helps.593745/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/arrima-error-3000.596861/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/federal-stage-step-by-step-process.501113/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/english-speaking-dentists-in-montreal.593686/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/wes-equivalency-is-same-for-quebec-as-well.480761/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-skilled-working-immigration.593874/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/montreal-job.596632/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-14\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-find-my-degree-in-arrima-portal.589848/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-visa.588862/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/no-mr-since-march-federal-stage-2017.527311/\n",
      "Count of thread pages: 18\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-noc-code.589340/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/urgent-cec-application-after-one-year-in-ontario-moving-to-quebec.588741/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/valid-job-offer-processing-time.590162/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/need-help-for-arrima-project.584837/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/any-recent-statement-of-that-persons-assets-cash-investments-shares-units-bonds-etc-and-inc.588449/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/assessment-of-educational-credentials-for-quebec.348192/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/applying-for-federal-without-csq-and-related-questions.589398/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/medicle-exam.592376/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/work-permit.585655/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/non-resident-citizen-sponsor-spouse-to-quebec.484761/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-application-requirements.592269/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-quebec.570780/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/name-change.588632/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/i-dont-think-anyone-will-receive-one-lots-of-news-about-the-new-immigration-minister-tightening-up.591626/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/how-to-apply-in-as-a-caregiver.503418/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/spouse-owp.592254/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/residency-application-as-a-common-law-couple-that-separate-mid-application.590883/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canadian-citizen-trying-to-bring-mexican-girlfriend-to-live-and-work-in-canada-quebec.592774/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/inquires.591777/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/received-my-csq-for-family-sponsorship-whats-the-next-step.580810/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/mon-project-quebec-2018-till-august-2.590967/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canada-immigration.591514/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/stay-in-quebec-with-caq-after-expiry-of-visa.592309/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/nurses-registration-in-quebec.590963/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-15\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq.584956/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/should-postdoctor-be-treated-as-a-validated-job-offer.584309/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/waiting-for-csq-since-december-2015.574409/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-applicants-tracking-2016.428807/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/arrima.584184/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/valid-csq-needed-to-enter-montreal.525262/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/college-fee-refund.583678/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/qsw-federal-stage-us-applicants.585824/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/caq-time-period.584784/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/help-aide-qc-immigration.587194/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/dr.583013/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/what-happens-if-i-submitted-two-times-an-application-for-pr.587686/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/common-law-inland-applicant-why-no-ramq.587135/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-fees-and-gic.581727/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/already-have-ajob-offer-caq-and-lmia-but-i-dont-have-the-degree-required-in-noc.579215/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec.583237/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canadian-company-outside-canada.585977/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/study-permit-delayed.584137/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-holder-and-applying-for-work-permit.582087/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq.585490/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/landing-with-expired-csq.452544/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/applying-for-pr-having-peq-and-sponsorship.581478/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/skilled-immigrants-on-desperate-hunt-for-jobs-in-quebec.585692/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/question-about-eligibility-for-open-work-permit-under-the-quebec-investor-program.586199/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-immigraiton-mon-projet.586298/\n",
      "Topic URL: https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/page-16\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/applying-for-quebec-pr-with-masters-from-ontario.576184/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/anyone-going-to-montreal-in-jan-feb-intake.579976/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/getting-married-in-december-looking-for-advice-asap.578967/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-cancelled-again-received-medical-examination-papers.574621/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/application-for-pr-while-visa-is-pending.577870/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-skilled-worker-program-and-the-quebec-experience-class.580550/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-applying-late.574459/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/forgot-answers-of-security-questions-to-login-in-mon-quebec-project-any-help.393359/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-there-anyone-who-got-a-french-interview-even-though-he-she-got-a-socre-b2-of-tefaq.534283/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/processing-of-online-applications-starting-by-july-15-2017.503211/\n",
      "Count of thread pages: 2\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/canada-college-montreal.574176/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-selection-certificate.578361/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/new-formulaire-dengagement-as-of-august-2nd.577883/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/is-there-need-to-reapply-caq.578147/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/phd-student-in-the-trap.574640/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-new-immigration.575162/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-area-of-training-section-of-bachelor-of-engineering-in-electronics-and-communication-engineerin.579491/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/new-points-new-table.478671/\n",
      "Count of thread pages: 7\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/january-intake-quebec-2019-for-non-sds-general-category.575189/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/question-regarding-2018-intake.568829/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/quebec-skilled-worker-help-please.575504/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/regarding-pr-with-family-to-quebec.574200/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/recherche-de-participants-entrevue-pour-un-projet-de-recherche-sur-les-couples-immigrants.575055/\n",
      "Thread URL: https://www.canadavisa.com/canada-immigration-discussion-board/threads/csq-applicant-june-august-2016-application-update.478443/\n"
     ]
    }
   ],
   "source": [
    "\n",
    "total_message_ids = list()\n",
    "total_links = list()\n",
    "total_date_contents = list()\n",
    "total_username_contents = list()\n",
    "total_message_contents = list()\n",
    "total_countries = list()\n",
    "total_likes = list()\n",
    "total_topic_contents = list()\n",
    "total_thread_contents = list()\n",
    "\n",
    "\n",
    "message_ids = list()\n",
    "links = list()\n",
    "date_contents = list()\n",
    "username_contents = list()\n",
    "message_contents = list()\n",
    "countries = list()\n",
    "likes = list()\n",
    "topic_contents = list()\n",
    "thread_contents = list()\n",
    "counter = 0\n",
    "thread_counter = 0\n",
    "thread_page_counter = 0\n",
    "\n",
    "# Full data set\n",
    "#for key, value in topic_titles_and_links.items():\n",
    "# Random sample\n",
    "for key, value in topic_sample_titles_and_links.items():\n",
    "    counter = counter + 1\n",
    "\n",
    "# For debugging only - COMMENT OUT LATER\n",
    "   # if counter > 2:\n",
    "    #    break\n",
    "    topic_url = 'https://www.canadavisa.com' + value \n",
    "    topic_title = key\n",
    "\n",
    "    print(\"Processing \", topic_title)\n",
    "    try:\n",
    "        topic_content = bs(requests.get(topic_url).text, 'html.parser')\n",
    "        # Count number of page nav elements\n",
    "        page_nav_count = len(topic_content.select('li.pageNav-page'))\n",
    "        tc_last_page = int(topic_content.select('li.pageNav-page')[page_nav_count - 1].text)\n",
    "        print(\"Count of topic pages: \" + str(tc_last_page))\n",
    "        #tc_last_page = int(re.search('Page \\d* of (\\d*)', topic_content.select('li.pageNav-page')[0].text).group(1))\n",
    "    except Exception as i:\n",
    "        pass\n",
    "        \n",
    "    #for x in range(1, tc_last_page + 1):\n",
    "    topic_sample = range(1, tc_last_page + 1)\n",
    "    if (len(topic_sample) > PAGE_SAMPLE_SIZE):\n",
    "        topic_sample = random.sample(topic_sample, PAGE_SAMPLE_SIZE)\n",
    "    for x in topic_sample:\n",
    "# For debugging only - COMMENT OUT LATER\n",
    "        topic_url = 'https://www.canadavisa.com' + value\n",
    "        if x > 1:\n",
    "            topic_url = topic_url + 'page-'+ str(x)\n",
    "        print(\"Topic URL: \" + topic_url)\n",
    "        topic_content = bs(requests.get(topic_url).text, 'html.parser')\n",
    "        threads = topic_content.find_all('div', {'class':'structItem-title'})\n",
    "        threads_titles = list(map(lambda subtopic: subtopic.find('a').text.strip(), threads))\n",
    "        thread_titles_and_links = dict(map(lambda subtopic: (subtopic.find('a').text.strip(), subtopic.find('a') ['href']), threads))\n",
    "\n",
    "        # Randomise threads\n",
    "        thread_sample_titles_and_links = sample_links(thread_titles_and_links, threads_titles, SAMPLE_SIZE)\n",
    "        thread_counter = 1\n",
    "\n",
    "        \n",
    "        for st_key, st_value in thread_sample_titles_and_links.items():\n",
    "            thread_counter = thread_counter + 1\n",
    "            thread_url = 'https://www.canadavisa.com' + st_value\n",
    "            print(\"Thread URL: \" + thread_url)\n",
    "            thread_title = st_key\n",
    "            thread_content = bs(requests.get(thread_url).text, 'html.parser')\n",
    "\n",
    "            last_page = 1\n",
    "            try:\n",
    "                thread_page_nav_count = len(thread_content.select('li.pageNav-page'))\n",
    "                #last_page = int(re.search('Page \\d* of (\\d*)', thread_content.select('li.pageNav-page')[0].text).group(1))\n",
    "                last_page = int(thread_content.select('li.pageNav-page')[thread_page_nav_count - 1].text)\n",
    "                print(\"Count of thread pages: \" + str(last_page))\n",
    "            except Exception as e: \n",
    "                pass\n",
    "            \n",
    "            #for y in range(1, last_page):\n",
    "            thread_sample = range(1, last_page + 1)\n",
    "            if (len(thread_sample) > PAGE_SAMPLE_SIZE):\n",
    "                thread_sample = random.sample(thread_sample, PAGE_SAMPLE_SIZE)\n",
    "\n",
    "            for y in thread_sample:\n",
    "# For debugging only - COMMENT OUT LATER\n",
    "                #if y > 3:\n",
    "                #    break\n",
    "\n",
    "                thread_url = 'https://www.canadavisa.com' + st_value\n",
    "                if y > 1:\n",
    "                    thread_url = thread_url + 'page-' + str(y)\n",
    "                    \n",
    "                thread_content = bs(requests.get(thread_url).text, 'html.parser')\n",
    "                #CHANGED - WORKS\n",
    "                messages = thread_content.select('div.bbWrapper')\n",
    "                #NOT WORKING - IDS CONCEALED \n",
    "                message_urls = list(map(lambda permLink: permLink['href'], thread_content.select('div.message-attribution-main > a')))\n",
    "                message_reactions = thread_content.select('div.message-userExtras > dl:nth-of-type(3) > dd')\n",
    "                message_reactionsbar = thread_content.select('div.reactionsBar')\n",
    "                message_likes = list(map(lambda rb: len(rb.select('bdi')), message_reactionsbar))\n",
    "                times = thread_content.select('time')\n",
    "                if (times is not None):\n",
    "                    message_dates = list(map(lambda date: date.decode_contents().strip(), times))\n",
    "                message_usernames = thread_content.select('a.username')\n",
    "                message_list = list(map(lambda message: (message.decode_contents().strip()), messages))\n",
    "                usernames_list = list(map(lambda a: a.text.strip(), message_usernames))\n",
    "                for idx, m in enumerate(message_list):\n",
    "                    #message_id = \"\"\n",
    "                    #try:\n",
    "                     #   message_id = re.search('post-(\\d*)', m_ids[idx]['id']).group(1)\n",
    "                    #except IndexError:\n",
    "                     #   message_id = \"\"\n",
    "                    #message_ids.append(message_id)\n",
    "                    message_ids.append(0)\n",
    "                    link = \"\"\n",
    "                    try:\n",
    "                        link = 'https://www.canadavisa.com/' + message_urls[idx]\n",
    "                    except IndexError:\n",
    "                        link = \"\"\n",
    "                    links.append(link)\n",
    "                    message_date = \"\"\n",
    "                    try:\n",
    "                        #message_date = message_dates[idx]['title']\n",
    "                        message_date = message_dates[idx]\n",
    "                    except IndexError:\n",
    "                        message_date = \"\"\n",
    "                    date_contents.append(message_date)\n",
    "                    message_username = \"\"\n",
    "                    try:\n",
    "                        message_username = usernames_list[idx]\n",
    "                    except IndexError:\n",
    "                        message_username = \"\"\n",
    "                    username_contents.append(message_username)\n",
    "                    \n",
    "                    message_contents.append(m.replace('\\n', \"\"))\n",
    "\n",
    "                    countries.append(\"NA\")\n",
    "                    like = 0\n",
    "                    try:\n",
    "                        like = message_likes[idx]\n",
    "                    except IndexError:\n",
    "                        like = 0\n",
    "                    likes.append(like)\n",
    "                    topic_contents.append(topic_title)\n",
    "                    thread_contents.append(thread_title)\n",
    "    # Here write the contents to a file, and re-set the data structures\n",
    "    base_data_frame = data_frame(message_ids, links, date_contents, username_contents, message_contents, countries, likes, topic_contents, thread_contents)\n",
    "    write_csv(\"can-forum-\" + str(counter) + \".csv\", base_data_frame)\n",
    "    total_message_ids.extend(message_ids)\n",
    "    total_links.extend(links)\n",
    "    total_date_contents.extend(date_contents)\n",
    "    total_username_contents.extend(username_contents)\n",
    "    total_message_contents.extend(message_contents)\n",
    "    total_countries.extend(countries)\n",
    "    total_likes.extend(likes)\n",
    "    total_topic_contents.extend(topic_contents)\n",
    "    total_thread_contents.extend(thread_contents)\n",
    "    message_ids = list()\n",
    "    links = list()\n",
    "    date_contents = list()\n",
    "    username_contents = list()\n",
    "    message_contents = list()\n",
    "    countries = list()\n",
    "    likes = list()\n",
    "    topic_contents = list()\n",
    "    thread_contents = list()\n",
    "\n",
    "total_base_data_frame = data_frame(total_message_ids, total_links, total_date_contents, total_username_contents, total_message_contents, total_countries, total_likes, total_topic_contents, total_thread_contents)    \n",
    "write_csv(\"can-forum-ALL.csv\", total_base_data_frame)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create empty frame\n",
    "#base_data_frame = pd.DataFrame({ \"ID\": message_ids, \"Link\": links, \"Date\": date_contents, \"Username\": username_contents, \"Message\": message_contents, \"Country\": [], \"Like\": [], \"Topic\": topic_contents, \"Thread\": thread_contents})\n",
    "base_data_frame = pd.DataFrame({ \"ID\": message_ids, \n",
    "                                \"Link\": links, \n",
    "                                \"Date\": date_contents,\n",
    "                                \"Username\": username_contents, \n",
    "                                \"Message\": message_contents, \n",
    "                                \"Country\": countries, \n",
    "                                \"Like\": likes, \n",
    "                                \"Topic\": topic_contents, \n",
    "                                \"Thread\": thread_contents})\n",
    "print('Finished')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "len(base_data_frame)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# from https://github.com/pandas-dev/pandas/issues/22610\n",
    "import csv\n",
    "with open(\"can-forum.csv\", \"w\", errors='surrogatepass') as _file:\n",
    "    writer = csv.writer(_file)\n",
    "    #writer.writerow(row)\n",
    "    writer.writerow(base_data_frame.columns.values)\n",
    "    for index, row in base_data_frame.iterrows():\n",
    "        writer.writerow(row)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "base_data_frame.iloc[0:100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#print(topic_content)\n",
    "tc_last_page = int(re.search('Page \\d* of (\\d*)', topic_content.select('h3', {'class':'pageNav-page'})))\n",
    "print(tc_last_page)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "https://www.canadavisa.com/canada-immigration-discussion-board/forums/quebec-immigration.55/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "int(re.search('Page \\d* of (\\d*)', 'Page 1 of 1280').group(1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "thread_sample_titles_and_links = sample_links(thread_titles_and_links, threads_titles, SAMPLE_SIZE)\n",
    "#print(thread_sample_titles_and_links)\n",
    "for st_key, st_value in thread_sample_titles_and_links.items():\n",
    "            thread_counter = thread_counter + 1\n",
    "thread_url = 'https://www.canadavisa.com' + st_value\n",
    "print(thread_url)\n",
    "thread_content = bs(requests.get(thread_url).text, 'html.parser')\n",
    "last_page = 1\n",
    "try:\n",
    "    last_page = int(re.search('Page \\d* of (\\d*)', thread_content.select('li.pageNav-page')[0].text).group(1))\n",
    "except Exception as e: \n",
    "    print(e)\n",
    "    for x in range(1, last_page + 1):\n",
    "# For debugging only - COMMENT OUT LATER\n",
    "                #if x > 3:\n",
    "               #     break\n",
    "            \n",
    "                    #thread_url = 'https://www.canadavisa.com' + st_value\n",
    "                if x > 1:\n",
    "                    thread_url = thread_url + 'page-' + str(x)\n",
    "                print(thread_url)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "thread_content = bs(requests.get(thread_url).text, 'html.parser')\n",
    "#print(thread_content)\n",
    "message_usernames = thread_content.select('a.username')\n",
    "usernames_list = list(map(lambda a: a.text.strip(), message_usernames))\n",
    "tc_last_page = int(re.search('Page \\d* of (\\d*)', topic_content.select('div.pageNav-page')[0].text).group(1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(sample_titles_and_links)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
